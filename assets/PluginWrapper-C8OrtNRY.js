import{u as m,r as c,R as s,af as L,ag as h,L as v,C as I,a as R,P as o,j as u}from"./index-BBPt-6mJ.js";import{aq as A,eC as S,eY as T}from"./index-MWAYkAOF.js";const l={READY:"READY",INSTALLING:"INSTALLING"};function d({installingWorker:e,onStateChange:t}){e.onstatechange=()=>{e.state==="activated"&&t(l.READY)}}async function b({onStateChange:e}){if(!navigator.serviceWorker)return null;const t=await navigator.serviceWorker.getRegistration();return t?t.active?l.READY:t.installing?(d({installingWorker:t.installing,onStateChange:e}),l.INSTALLING):(t.onupdatefound=()=>{e(l.INSTALLING);const r=t.installing;r&&d({installingWorker:r,onStateChange:e})},null):null}const y=()=>s.createElement(v,null,s.createElement(I,null,s.createElement(R,null))),f=({id:e,children:t,isParentCached:r=!1})=>{const{startRecording:a,isCached:n,remove:i}=L(e);return c.useEffect(()=>{const g=r&&!n,E=!r&&n;g&&a({onError:console.error}),E&&i()},[n,r,i,a]),s.createElement(h,{id:e,loadingMask:s.createElement(y,null)},t)};f.propTypes={children:o.node,id:o.string,isParentCached:o.bool};const p=({onInstallationStatusChange:e=Function.prototype,children:t,cacheId:r,isParentCached:a=!1,...n})=>{const{pwaEnabled:i}=m();return c.useEffect(()=>{b({onStateChange:e}).then(e)},[e]),n?s.createElement("div",{style:{display:"flex",height:"100%",overflow:"hidden"}},i?s.createElement(f,{id:r,isParentCached:a},t(n)):t(n),s.createElement(A,{colors:!0,spacers:!0,elevations:!0})):null};p.propTypes={cacheId:o.string,children:o.func,isParentCached:o.bool,onInstallationStatusChange:o.func};const W=e=>{const[t,r]=c.useState(null);return c.useLayoutEffect(()=>{const a=S(()=>r(n=>typeof n=="number"?n+1:1),300);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),u.jsx(p,{...e,children:a=>u.jsx(T,{id:t,...a})})};export{W as default};
//# sourceMappingURL=PluginWrapper-C8OrtNRY.js.map
