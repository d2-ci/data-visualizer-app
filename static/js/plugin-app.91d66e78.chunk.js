(self.webpackChunkdata_visualizer_app=self.webpackChunkdata_visualizer_app||[]).push([[3524],{1677:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ma});var n=a(8505),i=a(5868),s=a(985),l=a(7299),o=a(5448),r=a(1882),d=a.n(r),u=a(7425),c=a(258),p=a.n(c),m=a(8418),h=a(937),v=a(4786),g=a(8721),b=a(1543),f=a(3870),y=a(8580);a(3379),a(5442),a(7993),a(527),a(5111);const S=()=>m.createElement("svg",{width:"100",height:"100",xmlns:"http://www.w3.org/2000/svg"},m.createElement("path",{d:"M96.4184693 4.6480742l-2.9759268 2.6728C91.5558812 5.2202435 88.8786031 4 86 4V0c4.0260387 0 7.7809122 1.7113874 10.4184693 4.6480742zM100 19.269042h-4l-.0000544-5.3024514c-.0043849-1.346405-.2739964-2.6517927-.7866406-3.8623659l3.6833463-1.559795c.7189815 1.6978243 1.0971493 3.5288134 1.1032837 5.4156229L100 19.269042zm0 13.9999755h-4v-10h4v10zm0 14h-4v-10h4v10zm0 14h-4v-10h4v10zm0 13.9999995h-4v-9.9999995h4v9.9999995zm-.516108 14.50858l-3.8521996-1.077292C95.8751624 87.829701 96 86.924153 96 86v-6.730983h4V86c0 1.289184-.1747984 2.557136-.516108 3.777597zM87.7213345 99.895024l-.4874961-3.970182c2.8302961-.34753 5.3578432-1.892491 6.9762006-4.213767l3.2812621 2.287645c-2.2629208 3.245799-5.802045 5.409086-9.7699666 5.896304zM73.461965 100v-4h10v4h-10zm-14 0v-4h10v4h-10zm-14 0v-4h10v4h-10zm-14 0v-4h10v4h-10zm-14 0v-4h10v4h-10zM3.17264828 94.875717l3.09219912-2.537382c1.79303608 2.185097 4.4211055 3.525451 7.2855127 3.651773l-.176231 3.996116c-4.01094422-.176885-7.69477669-2.055693-10.20148082-5.110507zM0 80.192922h4l.00006331 5.84312c.00418159 1.190127.21554574 2.348454.61951638 3.438567L.86883696 90.864547C.3022517 89.335619.0059261 87.711683.00007566 86.043095L0 80.192922zm0-13.999974h4v10H0v-10zm0-14.0000005h4v10H0v-10zm0-14h4v10H0v-10zm0-14h4v10H0v-10zM.701349 9.6140131l3.79891292 1.2523021C4.17021443 11.8675286 4 12.9209553 4 14v6.1929475H0V14c0-1.5058511.2385093-2.9819426.701349-4.3859869zM12.9113947.0417954l.3073341 3.9881757c-2.8514503.2197365-5.43930476 1.6474003-7.16021518 3.8917822l-3.1742768-2.4339201C5.29022999 2.3499781 8.91606935.3496804 12.9113947.0417954zM27.07607 0v4h-10V0h10zm14 0v4h-10V0h10zm14 0v4h-10V0h10zm14 0v4h-10V0h10zm14 0v4h-10V0h10z",fill:"#A0ADBA",fillRule:"nonzero"})),E=()=>m.createElement("svg",{height:"96",viewBox:"0 0 96 96",width:"96",xmlns:"http://www.w3.org/2000/svg"},m.createElement("g",{fill:"#a0adba",transform:"translate(3 3)"},m.createElement("path",{d:"m40.5 73.5000001c0 2.4852813 2.0147186 4.5 4.5 4.5s4.5-2.0147187 4.5-4.5c0-2.4142734-1.9012365-4.3844892-4.2881643-4.4951021l-.2128322-.0048979c-2.4848234.0005384-4.4990035 2.0150507-4.4990035 4.5z"}),m.createElement("path",{d:"m48 60v-30c0-1.6568542-1.3431458-3-3-3s-3 1.3431458-3 3v30c0 1.6568542 1.3431458 3 3 3s3-1.3431458 3-3z"}),m.createElement("path",{d:"m45-2.99904788c3.8985931 0 7.4578604 2.21715778 9.1770339 5.71709169l37.8912554 77.19048409c1.3845546 2.8165473 1.2171646 6.1482722-.4427191 8.811863-1.6598833 2.6635901-4.5771005 4.2816904-7.7135702 4.2796124h-77.82201115c-3.13845856.002078-6.05567574-1.6160223-7.71555901-4.2796124-1.65988369-2.6635908-1.82727377-5.9953157-.44346379-8.8103471l37.89234295-77.19269833c1.7188306-3.49923557 5.2780979-5.71639335 9.176691-5.71639335zm0 6c-1.6106864 0-3.0811818.91600885-3.7909661 2.36100407l-37.89274459 77.19351591c-.47005356.9562122-.41322496 2.0873262.15030227 2.99161.56352731.9042839 1.5539177 1.4529206 2.62140842 1.4529206h77.8259889c1.0655018 0 2.0558922-.5486367 2.6194195-1.4529206.5635272-.9042838.6203558-2.0353978.1495577-2.9931259l-37.8916571-77.19130167c-.7101272-1.44569356-2.1806226-2.36170241-3.791309-2.36170241z"})));var w=a(5775),T=a(5212);const x="CLEAR_SNACKBAR",A=e=>e.snackbar,_="Snackbar_container__RTXSS",D="error",C="warning",O=e=>{let{snackbar:t,onClose:a}=e;const{variant:n,message:i,duration:s}=t;return i&&m.createElement("div",{className:_},m.createElement(w.A,{duration:s,critical:n===D,success:"success"===n,warning:n===C,permanent:n===D||n===C,onHidden:a},i))};O.propTypes={snackbar:p().object,onClose:p().func};(0,T.Ng)((e=>({snackbar:A(e)})),(e=>({onClose:()=>e({type:x})})))(O);class z{constructor(e,t,a){this.icon=e,this.title=t,this.description=a}}class L extends z{constructor(){super(S,y.A.t("No data available"),y.A.t("The selected dimensions didnâ€™t return any data. There may be no data, or you may not have access to it."))}}class N extends z{constructor(){super(S,y.A.t("No outliers found"),y.A.t("There were no outliers found for the selected data items and options."))}}const I=y.A.t("Something went wrong"),M=(v.wG,v.Yy,v.xJ,e=>(0,b.J1)(g.M_).getPeriods().find((t=>t.id===e[0].id))?g.M_:(0,b.J1)(g._X).getPeriods().find((t=>t.id===e[0].id))?g._X:void 0),R="VisualizationErrorInfo_errorContainer__sNWMN",k="VisualizationErrorInfo_errorIcon__-QIhT",V="VisualizationErrorInfo_errorTitle__B5CHc",q="VisualizationErrorInfo_errorDescription__icw-K",P=e=>{let{error:t}=e;return m.createElement("div",{className:R,"data-test":"start-screen-error-container"},t instanceof z?m.createElement(m.Fragment,null,m.createElement("div",{className:k},t.icon()),m.createElement("p",{className:V},t.title),m.createElement("p",{className:q},t.description)):m.createElement(m.Fragment,null,m.createElement("div",{className:k},E()),m.createElement("p",{className:V},I),m.createElement("p",{className:q},t.message||t)))};P.propTypes={error:p().oneOfType([p().instanceOf(Error),p().instanceOf(z)])};var $=a(456),j=a(1153),W=a(7092),H=a(2438),U=a(5466),Y=a(4682),F=a(3655),G=a(7554),K=a(4875),B=a.n(K),J=a(7428);const Z={resource:"legendSets",params:e=>{let{ids:t}=e;return{fields:"id,displayName~rename(name),legends[id,displayName~rename(name),startValue,endValue,color]",filter:`id:in:[${t.join(",")}]`}}};var X=a(9839),Q=a(1745),ee=a(9326),te=(a(7179),a(8301)),ae=a(2184),ne=a(1759),ie=a(1152),se=a(302),le=a(5867);const oe="axisTitle",re="axisTitleTextMode",de="NORMAL",ue={axes:{requestable:!1,savable:!0,defaultValue:[]},colorSet:{defaultValue:se.P7,requestable:!1,savable:!0},cumulativeValues:{defaultValue:!1,requestable:!1,savable:!0},hideEmptyRowItems:{defaultValue:"NONE",requestable:!1,savable:!0},seriesKey:{defaultValue:{},requestable:!1,savable:!0},legend:{defaultValue:{},requestable:!1,savable:!0},noSpaceBetweenColumns:{defaultValue:!1,requestable:!1,savable:!0},percentStackedValues:{defaultValue:!1,requestable:!1,savable:!0},regressionType:{defaultValue:"NONE",requestable:!1,savable:!0},showData:{defaultValue:!0,requestable:!1,savable:!0},aggregationType:{defaultValue:"DEFAULT",requestable:!0,savable:!0},completedOnly:{defaultValue:!1,requestable:!0,savable:!0},hideSubtitle:{defaultValue:!1,requestable:!1,savable:!0},hideTitle:{defaultValue:!1,requestable:!1,savable:!0},sortOrder:{defaultValue:"0",requestable:!1,savable:!0},subtitle:{defaultValue:void 0,requestable:!1,savable:!0},title:{defaultValue:void 0,requestable:!1,savable:!0},series:{defaultValue:[],requestable:!1,savable:!0},fontStyle:{defaultValue:{},requestable:!1,savable:!0},outlierAnalysis:{requestable:!1,savable:!0,defaultValue:null},icons:{defaultValue:!1,requestable:!1,savable:!0},colTotals:{defaultValue:!1,requestable:!1,savable:!0},colSubTotals:{defaultValue:!1,requestable:!1,savable:!0},rowTotals:{defaultValue:!1,requestable:!1,savable:!0},rowSubTotals:{defaultValue:!1,requestable:!1,savable:!0},showDimensionLabels:{defaultValue:!1,requestable:!1,savable:!0},hideEmptyColumns:{defaultValue:!1,requestable:!1,savable:!0},hideEmptyRows:{defaultValue:!1,requestable:!1,savable:!0},skipRounding:{defaultValue:!1,requestable:!0,savable:!0},numberType:{defaultValue:"VALUE",requestable:!1,savable:!0},showHierarchy:{defaultValue:!1,requestable:!0,savable:!0},displayDensity:{defaultValue:"NORMAL",requestable:!1,savable:!0},fontSize:{defaultValue:de,requestable:!1,savable:!0},digitGroupSeparator:{defaultValue:"SPACE",requestable:!1,savable:!0},approvalLevel:{defaultValue:void 0,requestable:!0,savable:!1},fixColumnHeaders:{defaultValue:!1,requestable:!1,savable:!0},fixRowHeaders:{defaultValue:!1,requestable:!1,savable:!0},reportingPeriod:{defaultValue:!1,requestable:!1,savable:!0},organisationUnit:{defaultValue:!1,requestable:!1,savable:!0},parentOrganisationUnit:{defaultValue:!1,requestable:!1,savable:!0},grandParentOrganisationUnit:{defaultValue:!1,requestable:!1,savable:!0},regression:{defaultValue:!1,requestable:!1,savable:!0},cumulative:{defaultValue:!1,requestable:!1,savable:!0},measureCriteria:{defaultValue:void 0,requestable:!0,savable:!0},topLimit:{defaultValue:"0",requestable:!1,savable:!0}},ce=()=>Object.entries({...ue}).reduce(((e,t)=>{let[a,n]=t;return e[a]=n.defaultValue,e}),{}),pe=()=>Object.entries(ue).filter((e=>e[1].requestable)),me=e=>{var t;const a={...ce(),...(0,le.A)(e,Object.keys(ue))};return a.axes=a.axes.map((e=>{if(e.targetLine||e.baseLine){const t={...e};return t.targetLine&&(t.targetLine={...t.targetLine,enabled:!0}),t.baseLine&&(t.baseLine={...t.baseLine,enabled:!0}),t}return e})),a.icons=Boolean(null===(t=e.icons)||void 0===t?void 0:t.length),e.reportingParams&&(a.organisationUnit=e.reportingParams.organisationUnit,a.reportingPeriod=e.reportingParams.reportingPeriod,a.parentOrganisationUnit=e.reportingParams.parentOrganisationUnit,a.grandParentOrganisationUnit=e.reportingParams.grandParentOrganisationUnit),["sortOrder","topLimit"].forEach((t=>{Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=String(e[t]))})),a},he="VisualizationOptions_tabSectionOption__Y6aHl",ve="VisualizationOptions_tabSectionOptionToggleable__WR8+K";var ge=a(3234),be=a(3906);const fe=()=>m.createElement("svg",{height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.createElement("path",{d:"m7 5h6c2.209139 0 4 1.790861 4 4 0 .97998001-.3524116 1.8776499-.9374171 2.5731919 1.1608063.6986588 1.9374171 1.9720399 1.9374171 3.4268081 0 2.209139-1.790861 4-4 4h-7zm7 8h-5v4h5c1.1045695 0 2-.8954305 2-2 0-1.0543618-.8158778-1.9181651-1.8507377-1.9945143zm-1-6h-4v4h4c1.1045695 0 2-.8954305 2-2 0-1.0543618-.8158778-1.91816512-1.8507377-1.99451426z",fill:"#inherit"})),ye=e=>{let{color:t}=e;return m.createElement("svg",{height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.createElement("circle",{cx:"12",cy:"12",fillRule:"evenodd",fill:t,r:"7"}))};ye.defaultProps={color:"#000000"},ye.propTypes={color:p().string};const Se=ye,Ee=()=>m.createElement("svg",{height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.createElement("path",{d:"m13.5 7h-3.5v-2h9v2h-3.5l-5 10h3.5v2h-9v-2h3.5z",fill:"#inherit"})),we="TextStyle_container__wg3zm",Te="TextStyle_buttonStrip__1IoTX",xe="TextStyle_fontSizeSelect__1hlAu",Ae="TextStyle_textAlignSelect__L738N",_e="TextStyle_textColorLabel__TXegw",De="TextStyle_textColorInput__NsT9H",Ce="TextStyle_textColorIcon__1EA56",Oe="TextStyle_disabled__yqo+T",ze=e=>{let{fontStyleKey:t,fontStyle:a,visType:n,onChange:i,disabled:s,dataTest:l,isVertical:o}=e;const r=Object.values((0,ee.ZD)(t)),d=(0,ee.Fm)(t,o||(0,f.v2)(n)),c=(0,u.A)((e=>{i(ee.OE,e)}),100);return m.createElement("div",{className:we,"data-test":l},a[ee.MA]&&m.createElement(ge.Z,{onChange:e=>{let{selected:t}=e;i(ee.MA,Number(t))},selected:(a[ee.MA]||"").toString(),prefix:y.A.t("Size"),dense:!0,className:xe,disabled:s,dataTest:`${l}-font-size-select`},r.map((e=>{var t,a,n;return m.createElement(be.e,{key:null===(t=e.value)||void 0===t?void 0:t.toString(),value:null===(a=e.value)||void 0===a?void 0:a.toString(),label:e.label,dataTest:`${l}-font-size-option-${null===(n=e.value)||void 0===n?void 0:n.toString()}`})}))),a[ee.Eq]&&m.createElement(ge.Z,{onChange:e=>{let{selected:t}=e;i(ee.Eq,t)},selected:a[ee.Eq],prefix:y.A.t("Position"),dense:!0,className:Ae,disabled:s,dataTest:`${l}-text-align-select`},d.map((e=>{var t;return m.createElement(be.e,{key:e.value,value:e.value,label:e.label,dataTest:`${l}-text-align-option-${null===(t=e.value)||void 0===t?void 0:t.toString()}`})}))),m.createElement("div",{className:B()({[Te]:a[ee.OE]||a[ee.Ix]||a[ee.$O]})},a[ee.OE]&&m.createElement("label",{className:B()(_e,{[Oe]:s}),"data-test":`${l}-text-color-picker`},m.createElement("input",{type:"color",value:a[ee.OE],onInput:e=>c(e.target.value),className:De,disabled:s}),m.createElement("div",{className:Ce},m.createElement(Se,{color:a[ee.OE]}))),null!=a[ee.Ix]&&m.createElement(F.$,{icon:m.createElement(fe,null),onClick:()=>{i(ee.Ix,!a[ee.Ix])},small:!0,secondary:!0,toggled:a[ee.Ix],disabled:s,dataTest:`${l}-bold-toggle`}),null!=a[ee.$O]&&m.createElement(F.$,{icon:m.createElement(Ee,null),onClick:()=>{i(ee.$O,!a[ee.$O])},small:!0,secondary:!0,disabled:s,toggled:a[ee.$O],dataTest:`${l}-italic-toggle`})))};ze.propTypes={fontStyleKey:p().string.isRequired,dataTest:p().string,disabled:p().bool,fontStyle:p().object,isVertical:p().bool,visType:p().string,onChange:p().func};const Le=(0,T.Ng)(((e,t)=>({fontStyle:Fe(e,{id:t.fontStyleKey,axisId:t.axisId})||{},visType:Ye(e)})),((e,t)=>({onChange:(a,n)=>e(Be({optionId:t.fontStyleKey,axisId:t.axisId,fontStyleOption:a,value:n}))})))(ze),Ne="AUTO",Ie="NONE",Me="CUSTOM",Re=["#4292c6","#cb181d","#41ab5d","#6c66b8"],ke=e=>{let{axisId:t,fontStyleKey:a,textMode:n,onTextChange:i,onTextModeChange:s,title:l,hasCustomAxes:o,setTitleColor:r,fontStyle:d,setFontStyle:u,showAutoOption:c}=e;const p=e=>{let{value:n}=e;s(n),n!==Ne&&n!==Me||!o||d[ee.OE]!==ee.yu[a][ee.OE]?n===Ie&&i(null):r(Re[t.slice(-1)])};return m.createElement("div",{className:he,"data-test":"option-chart-title"},m.createElement(te.J,null,y.A.t("Axis title")),m.createElement(ae.D,{name:"title-selector",dense:!0},[...c?[{id:Ne,label:y.A.t("Auto generated from axis items")}]:[],{id:Ie,label:y.A.t("None")},{id:Me,label:y.A.t("Custom")}].map((e=>{let{id:t,label:a}=e;return m.createElement(ne.s,{key:t,label:a,value:t,dense:!0,onChange:p,checked:n===t})}))),n===Me?m.createElement("div",{className:ve},m.createElement(ie.F,{type:"text",onChange:e=>{let{value:t}=e;return i(t)},value:l,placeholder:y.A.t("Add a title"),inputWidth:"280px",dense:!0,dataTest:`${t}-axis-title-input`})):null,n===Ne||n===Me?m.createElement("div",{className:ve},m.createElement(Le,{fontStyleKey:a,dataTest:`${t}-axis-title-text-style`,axisId:t}),m.createElement(F.$,{onClick:()=>{u(o?{textColor:Re[t.slice(-1)]}:{})},disabled:Object.keys(d).every((e=>(e!==ee.OE||!o)&&d[e]===ee.yu[a][e]||e===ee.OE&&o&&d[e]===Re[t.slice(-1)])),small:!0},y.A.t("Reset style to default"))):null)};ke.propTypes={axisId:p().string,fontStyle:p().object,fontStyleKey:p().string,hasCustomAxes:p().bool,setFontStyle:p().func,setTitleColor:p().func,showAutoOption:p().bool,textMode:p().string,title:p().string,onTextChange:p().func,onTextModeChange:p().func};(0,T.Ng)(((e,t)=>({fontStyle:Fe(e,{id:t.fontStyleKey,axisId:t.axisId})||{},title:Fe(e,{axisId:t.axisId,id:oe}),textMode:Fe(e,{id:re,axisId:t.axisId})||Ie})),((e,t)=>({onTextChange:a=>e(Be({optionId:oe,axisId:t.axisId,value:a})),onTextModeChange:a=>e(Be({optionId:re,axisId:t.axisId,value:a})),setTitleColor:a=>e(Be({optionId:t.fontStyleKey,axisId:t.axisId,fontStyleOption:ee.OE,value:a})),setFontStyle:a=>e(Je({optionId:t.fontStyleKey,axisId:t.axisId,value:a}))})))(ke);const Ve="maxResults",qe="name",Pe=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{[qe]:e,...t}},$e={reportTable:[Pe("cumulative",{option:!0}),Pe("hideEmptyColumns",{option:!0}),Pe("measureCriteria",{option:!0}),Pe("numberType",{option:!0}),Pe("regression",{option:!0}),Pe("reportingParams",{option:!0}),Pe("skipRounding",{option:!0}),Pe("fixColumnHeaders",{option:!0}),Pe("fixRowHeaders",{option:!0})],chart:[Pe("category",{excluded:!0}),Pe("icons",{option:!0}),Pe("yearlySeries")],eventReport:[Pe("dataType")],reportTable_eventReport:[Pe("colSubTotals",{option:!0}),Pe("colTotals",{option:!0}),Pe("displayDensity",{option:!0}),Pe("fontSize",{option:!0}),Pe("hideEmptyRows",{option:!0}),Pe("rowSubTotals",{option:!0}),Pe("rowTotals",{option:!0}),Pe("showDimensionLabels",{option:!0}),Pe("showHierarchy",{option:!0})],chart_eventChart:[Pe("axes",{option:!0}),Pe("colorSet",{option:!0}),Pe("cumulativeValues",{option:!0}),Pe("fontStyle",{option:!0}),Pe("hideEmptyRowItems",{option:!0}),Pe("seriesKey",{option:!0}),Pe("legend",{option:!0}),Pe("noSpaceBetweenColumns",{option:!0}),Pe("percentStackedValues",{option:!0}),Pe("regressionType",{option:!0}),Pe("series",{option:!0}),Pe("showData",{option:!0}),Pe("outlierAnalysis",{option:!0}),Pe("type",{option:!0})],eventReport_eventChart:[Pe("attributeValueDimension"),Pe("collapseDataDimensions"),Pe("dataElementValueDimension"),Pe("endDate"),Pe("eventStatus",{option:!0}),Pe("hideNaData",{option:!0}),Pe("outputType",{option:!0}),Pe("program"),Pe("programStage"),Pe("programStatus",{option:!0}),Pe("startDate"),Pe("value")],reportTable_eventReport_eventChart:[Pe("columnDimensions",{excluded:!0}),Pe("rowDimensions",{excluded:!0})],reportTable_chart_eventReport_eventChart:[Pe("access"),Pe("aggregationType",{option:!0}),Pe("attributeDimensions",{excluded:!0}),Pe("attributeValues",{excluded:!0}),Pe("categoryDimensions",{excluded:!0}),Pe("categoryOptionGroupSetDimensions",{excluded:!0}),Pe("code",{excluded:!0}),Pe("columns"),Pe("completedOnly",{option:!0}),Pe("created"),Pe("dataDimensionItems"),Pe("dataElementDimensions",{excluded:!0}),Pe("dataElementGroupSetDimensions",{excluded:!0}),Pe("description"),Pe("digitGroupSeparator"),Pe("displayDescription"),Pe("displayName"),Pe("displayShortName"),Pe("displaySubtitle"),Pe("displayTitle"),Pe("externalAccess",{excluded:!0}),Pe("favorite"),Pe("favorites"),Pe("filterDimensions",{excluded:!0}),Pe("filters"),Pe("hideSubtitle",{option:!0}),Pe("hideTitle",{option:!0}),Pe("href"),Pe("id"),Pe("interpretations"),Pe("itemOrganisationUnitGroups",{excluded:!0}),Pe("lastUpdated"),Pe("lastUpdatedBy"),Pe("name"),Pe("organisationUnitGroupSetDimensions",{excluded:!0}),Pe("organisationUnitLevels",{excluded:!0}),Pe("organisationUnits",{excluded:!0}),Pe("parentGraphMap"),Pe("periods",{excluded:!0}),Pe("programIndicatorDimensions",{excluded:!0}),Pe("publicAccess"),Pe("relativePeriods",{excluded:!0}),Pe("rows"),Pe("shortName"),Pe("sorting"),Pe("sortOrder",{option:!0}),Pe("subscribed"),Pe("subscribers"),Pe("subtitle",{option:!0}),Pe("timeField"),Pe("title",{option:!0}),Pe("topLimit",{option:!0}),Pe("translations"),Pe("user"),Pe("userAccesses"),Pe("userGroupAccesses"),Pe("userOrganisationUnit",{excluded:!0}),Pe("userOrganisationUnitChildren",{excluded:!0}),Pe("userOrganisationUnitGrandChildren",{excluded:!0})]};$e.visualization=[...$e.reportTable,...$e.chart,...$e.reportTable_eventReport,...$e.chart_eventChart,...$e.reportTable_eventReport_eventChart,...$e.reportTable_chart_eventReport_eventChart];const je=e=>{var t;return null!==(t=e.sorting)&&void 0!==t&&t.length?{dimension:e.sorting[0].dimension,direction:e.sorting[0].direction.toLowerCase()}:void 0},We="SET_UI_OPTION",He="SET_UI_OPTION_FONT_STYLE",Ue=(f.a0,ce(),v.wG,v.xJ,v.Yy,v.Yy,v.xJ,e=>e.ui),Ye=e=>Ue(e).type,Fe=(e,t)=>{var a,n,i,s,l,o,r,d,u,c,p,m,h,v,g,b,f,y,S,E,w,T,x;const A=Ue(e).options,[_,D]=(t.axisId||"").split("_");let C;if(t.name)C=A[t.name];else if(t.id)switch(t.id){case"maxValue":case"minValue":case"decimals":case"steps":C=Ge(A.axes,Number(D),_)[t.id];break;case re:C=null===(a=Ge(A.axes,Number(D),_).title)||void 0===a?void 0:a.textMode;break;case oe:C=null===(n=Ge(A.axes,Number(D),_).title)||void 0===n?void 0:n.text;break;case"showSeriesKey":C=null===(i=A.seriesKey)||void 0===i?void 0:i.hidden;break;case"legendDisplayStrategy":C=null===(s=A.legend)||void 0===s?void 0:s.strategy;break;case"legendDisplayStyle":C=null===(l=A.legend)||void 0===l?void 0:l.style;break;case"showLegendKey":C=null===(o=A.legend)||void 0===o?void 0:o.showKey;break;case"legendSet":C=null===(r=A.legend)||void 0===r?void 0:r.set;break;case ee.As:C=Ke(t.id,null===(d=A.seriesKey)||void 0===d||null===(u=d.label)||void 0===u?void 0:u.fontStyle);break;case"baseLineEnabled":C=null===(c=Ge(A.axes,Number(D),_).baseLine)||void 0===c?void 0:c.enabled;break;case"baseLineTitle":C=null===(p=Ge(A.axes,Number(D),_).baseLine)||void 0===p||null===(m=p.title)||void 0===m?void 0:m.text;break;case"baseLineValue":C=null===(h=Ge(A.axes,Number(D),_).baseLine)||void 0===h?void 0:h.value;break;case"baseLineTitleFontStyle":C=Ke(ee.p,null===(v=Ge(A.axes,Number(D),_).baseLine)||void 0===v||null===(g=v.title)||void 0===g?void 0:g.fontStyle);break;case"targetLineEnabled":C=null===(b=Ge(A.axes,Number(D),_).targetLine)||void 0===b?void 0:b.enabled;break;case"targetLineTitle":C=null===(f=Ge(A.axes,Number(D),_).targetLine)||void 0===f||null===(y=f.title)||void 0===y?void 0:y.text;break;case"targetLineValue":C=null===(S=Ge(A.axes,Number(D),_).targetLine)||void 0===S?void 0:S.value;break;case"targetLineTitleFontStyle":C=Ke(ee.p,null===(E=Ge(A.axes,Number(D),_).targetLine)||void 0===E||null===(w=E.title)||void 0===w?void 0:w.fontStyle);break;case ee.sj:C=Ke(t.id,null===(T=Ge(A.axes,Number(D),_).label)||void 0===T?void 0:T.fontStyle);break;case ee.mx:case ee.EJ:C=Ke(t.id,null===(x=Ge(A.axes,Number(D),_).title)||void 0===x?void 0:x.fontStyle);break;case ee.gZ:case ee.GT:C=Ke(t.id,(A.fontStyle||{})[t.id])}return C},Ge=function(){let e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0;return{...(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find((a=>a.index===e&&a.type===t))||{index:Number(e),type:t}}},Ke=(e,t)=>({...ee.yu[e],...t||{}}),Be=e=>({type:We,value:e}),Je=e=>({type:He,value:e});var Ze=a(9201);const Xe=e=>{let{methods:t,currentMethodId:a,onMethodChange:n,currentThreshold:i,onThresholdChange:s}=e;return m.createElement(m.Fragment,null,m.createElement("div",{className:he},m.createElement(ae.D,{dataTest:"options-outliers-detection-method",dense:!0},t.map((e=>{let{id:t,label:i}=e;return m.createElement(ne.s,{key:t,label:i,value:t,checked:a===t,onChange:e=>{let{value:t}=e;n(t)},dense:!0})}))),m.createElement(Ze._,null,y.A.t("Each detection method identifies outliers in different ways and suits different data. Check the documentation for help to choose the right outlier detection method"))),m.createElement(ie.F,{type:"number",label:y.A.t("Threshold factor"),min:"0",step:"0.5",onChange:e=>{let{value:t}=e;return s(t)},value:(null==i?void 0:i.toString())||"",helpText:y.A.t("A high value is more sensitive so fewer data items will be identified as outliers"),placeholder:y.A.t("Number"),inputWidth:"96px",dense:!0,dataTest:"options-outliers-threshold"}))};Xe.propTypes={methods:p().array.isRequired,onMethodChange:p().func.isRequired,onThresholdChange:p().func.isRequired,currentMethodId:p().string,currentThreshold:p().number};const Qe="outlierMethod",et="thresholdFactor",tt="STANDARD_Z_SCORE",at="MODIFIED_Z_SCORE",nt=(y.A.t("Z-score / Standard score"),y.A.t("Modified Z-score"),v.xJ),it=async(e,t,a)=>{const n=Q.A.getAnalytics(e),i=(new n.request).fromVisualization(t).withParameters(a).withIncludeNumDen(t.type===f.eh),s=await n.aggregate.get(i);return[new n.response(s)]},st=e=>{let{analyticsEngine:t,visualization:a,options:n,forDownload:i=!1}=e;const s=(e=>{let{showHierarchy:t}=e;return{[v.wG]:"dxname",[v.Yy]:t?"ounamehierarchy":"ouname",[v.xJ]:"pename"}})(n),l={...n,maxResults:a.outlierAnalysis[Ve],algorithm:a.outlierAnalysis[Qe]===tt?"Z_SCORE":a.outlierAnalysis[Qe],threshold:a.outlierAnalysis[et]},o=a.columns||[],r=[];switch(o.forEach((e=>{let{dimension:t,items:a}=e;l[t]=t===v.xJ?a[0].id:a.map((e=>{let{id:t}=e;return t})).join(","),r.push(i?t:s[t]),t===v.wG&&r.push("cocname")})),r.push("value"),a.outlierAnalysis.outlierMethod){case at:r.push("median","modifiedzscore","medianabsdeviation");break;case tt:r.push("mean","zscore","stddev")}r.push("lowerbound","upperbound"),l.headers=r.join(",");const d=je(a);return d&&(l.orderBy=d.dimension,l.sortOrder=d.direction),(new t.request).withParameters(l)},lt=async(e,t,a)=>{const n=Q.A.getAnalytics(e),i=st({analyticsEngine:n,visualization:t,options:a}),s=await n.aggregate.getOutliersData(i);return[new n.response(s)]},ot=e=>{let{yearlySeriesRes:t,currentMonth:a,currentDay:n}=e;const i=[],s=[],l=t.metaData.dimensions[nt].slice().sort().reverse(),o="02"===a&&"29"===n;return l.forEach((e=>{i.push(t.metaData.items[e].name);const l=29===new Date(e,1,29).getDate();o&&!l?s.push(`${e}-02-28`):s.push(`${e}-${a}-${n}`)})),{yearlySeriesLabels:i,periodDates:s}},rt=async e=>{let{analyticsEngine:t,visualization:a,options:n,yearlySeriesRes:i,currentMonth:s,currentDay:l}=e;const o=[],r=[],d=i.metaData.dimensions[nt].slice().sort().reverse(),u=d.shift();o.push(i.metaData.items[u].name),r.push(`${u}-${s}-${l}`);const c=(new t.request).fromVisualization(a).withParameters(n).withRelativePeriodDate(`${u}-${s}-${l}`).withSkipData(!0).withSkipMeta(!1),p=(await t.aggregate.fetch(c)).metaData.dimensions[nt].pop(),[m,h]=p.split("W"),v=u-m,g=d.reduce(((e,t)=>(o.push(i.metaData.items[t].name),e.push(`${t-v}W${h}`),"53"===h&&e.push(t-v+"W52"),e)),[]);if(g.length){const e=(new t.request).addPeriodDimension(g).withSkipData(!0).withSkipMeta(!1).withIncludeMetadataDetails(!0),a=await t.aggregate.fetch(e),n=[];a.metaData.dimensions[nt].sort().reverse().forEach((e=>{const t=e.substr(0,4);if(!n.includes(t)){const i=new Date(a.metaData.items[e].endDate);i.setDate(i.getDate()+1),r.push(`${i.getFullYear()}-${(""+(i.getMonth()+1)).padStart(2,0)}-${(""+i.getDate()).padStart(2,0)}`),n.unshift(t)}}))}return{yearlySeriesLabels:o,periodDates:r}},dt=e=>(e||[]).map((e=>{var t;return{...e,items:null==e||null===(t=e.items)||void 0===t?void 0:t.filter((e=>e.id!==X.IK))}})),ut=async e=>{let{dataEngine:t,visualization:a,filters:n,forDashboard:i,displayProperty:s}=e;const l={...a,columns:dt(a.columns),rows:dt(a.rows),filters:dt(a.filters)},o=((e,t,a)=>{const n=pe().reduce(((t,a)=>{let[n,i]=a;return void 0!==e[n]&&e[n]!==i.defaultValue&&(t[n]=e[n]),t}),{});if(t.relativePeriodDate&&(n.relativePeriodDate=t.relativePeriodDate),a&&(n.displayProperty=a.toUpperCase()),t.userOrgUnit&&t.userOrgUnit.length){const e=t.userOrgUnit.map((e=>e.split("/").slice(-1)[0]));n.userOrgUnit=e.join(";")}return n})(l,n,s),r={dashboard:i};if((0,f.jG)(l.type)){const{responses:e,yearlySeriesLabels:a}=await(async(e,t,a)=>{const n=Q.A.getAnalytics(e);let i=(new n.request).addPeriodDimension(t.yearlySeries).withSkipData(!0).withSkipMeta(!1).withIncludeMetadataDetails(!0);a.relativePeriodDate&&(i=i.withRelativePeriodDate(a.relativePeriodDate));const s=await n.aggregate.fetch(i),l=[],o=[],r=new Date,d=(""+r.getDate()).padStart(2,0),u=(""+(r.getMonth()+1)).padStart(2,0),c=(0,j.t)(t,nt);if(M(c)===g.M_&&!c[0].id===g.L5){const e=await rt({analyticsEngine:n,visualization:t,options:a,yearlySeriesRes:s,currentMonth:u,currentDay:d});l.push(...e.periodDates),o.push(...e.yearlySeriesLabels)}else if(M(c)===g._X){const e=ot({yearlySeriesRes:s,currentMonth:u,currentDay:d});l.push(...e.periodDates),o.push(...e.yearlySeriesLabels)}else s.metaData.dimensions[nt].sort().reverse().forEach((e=>{o.push(s.metaData.items[e].name),l.push(`${e}-${u}-${d}`)}));const p=l.reduce(((e,i)=>{const s=(new n.request).fromVisualization(t).withParameters(a).withRelativePeriodDate(i);return e.push(n.aggregate.get(s)),e}),[]);return Promise.all(p).then((e=>({responses:e.map((e=>new n.response(e))),yearlySeriesLabels:o})))})(t,l,o),n=(0,j.t)(l,v.xJ),i=M(n),s=((e,t)=>{const a=e.reduce(((e,t)=>(e.push(t.metaData.dimensions.pe),e)),[]);if(t===g._X){a.sort(((e,t)=>e[0].substr(-2)-t[0].substr(-2)));const e=a.shift().map((e=>[e]));return a.forEach((t=>{t.forEach((t=>{const a=t.match(/(\d{4})(\d{2})(\d{2})/),n=a[2],i=a[3],s=e.findIndex((e=>e[0].substr(4)===`${n}${i}`));if(-1!==s)e[s].push(t);else if("02"===n&&"29"===i){const a=e.findIndex((e=>-1!==e.findIndex((e=>/0228$/.test(e)))));-1!==a?e.splice(a+1,0,[t]):e.push([t])}else e.push([t])}))})),e}if(t===g.M_){a.sort(((e,t)=>t[0].split("W")[1]-e[0].split("W")[1]));const e=a.shift().map((e=>[e]));return a.forEach((t=>{t.forEach((t=>{const[a,n]=t.split("W"),i=e.findIndex((e=>e[0].split("W")[1]===n));if(-1!==i)e[i].push(t);else if("1"===n){const a=e.findIndex((e=>-1!==e.findIndex((e=>/W2$/.test(e)))));-1!==a?e[a].push(t):e.push([t])}else{const i=e.findIndex((e=>-1!==e.findIndex((e=>e===`${a}W${n-1}`))));e.splice(i+1,0,[t])}}))})),e}{const e=a.reduce(((e,t)=>(t.forEach(((t,a)=>{e[a].push(t)})),e)),Array.from({length:a[0].length},(()=>[])));return e}})(e,i),d=s.reduce(((e,t,a)=>(t.forEach((t=>e[t]=a)),e)),{}),u=i?((e,t)=>{switch(t){case g.M_:return e.map((e=>e[0].substr(4))).flat();case g._X:return e.map((e=>e[0].substr(4).replace(/(\d{2})(\d{2})/,"$2-$1"))).flat()}})(s,i):(e=>{const t=e.reduce(((e,t)=>(e.metaData?t.metaData.dimensions.pe.length>e.metaData.dimensions.pe.length&&(e=t):e=t,e)),{}).metaData;return t.dimensions.pe.reduce(((e,a)=>{const n=t.items[a].name;return e.push(n.replace(/\s+\d{4}$/,"")),e}),[])})(e);return{responses:e,extraOptions:{...r,yearlySeries:a,xAxisLabels:u,periodKeyAxisIndexMap:d}}}return(0,f.nT)(l.type)?{responses:await lt(t,l,o),extraOptions:r}:{responses:await it(t,l,o),extraOptions:r}};var ct=a(1337);const pt=e=>{let{visualization:t,responses:a,extraOptions:n,legendSets:i,id:s,style:l,onChartGenerated:o,animation:r,onToggleContextualMenu:d}=e;const u=(0,m.useRef)(void 0),c=(0,m.useRef)(l),p=(0,m.useRef)(s),h=(0,m.useCallback)((e=>{const s=(0,ct.$G)(a,t,u.current,{...n,animation:e,legendSets:i,onToggleContextualMenu:d},void 0,void 0,"highcharts");o(s.visualization.getSVGForExport({sourceHeight:768,sourceWidth:1024}))}),[u,t,o,d,a,n,i]);return(0,m.useEffect)((()=>{h(r)}),[t,a,n]),(0,m.useEffect)((()=>{s!==p.current&&(h(0),p.current=s)}),[s]),(0,m.useEffect)((()=>{l.width===c.current.width&&l.height===c.current.height||(h(0),c.current=l)}),[l]),m.createElement("div",{ref:u,style:l})};pt.defaultProps={visualization:{},filters:{},style:{},animation:200,id:null,onChartGenerated:Function.prototype},pt.propTypes={extraOptions:p().object.isRequired,legendSets:p().arrayOf(p().object).isRequired,responses:p().arrayOf(p().object).isRequired,visualization:p().object.isRequired,animation:p().number,id:p().number,style:p().object,onChartGenerated:p().func,onToggleContextualMenu:p().func};const mt=pt;var ht=a(8789),vt=a(6171),gt=a(5528),bt=a(1389);const ft=e=>{let{style:t={width:18,height:18}}=e;return m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",style:t},m.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),m.createElement("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z",fill:"black"}))};ft.propTypes={style:p().object};const yt=ft,St=e=>{let{style:t={width:18,height:18}}=e;return m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",style:t},m.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),m.createElement("path",{d:"M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z",fill:"black"}))};St.propTypes={style:p().object};const Et=St,wt=e=>{let{config:t,ouLevels:a,onClick:i,reference:s,dataTest:l}=e;const o=(0,n.ow)(),[r,d]=(0,m.useState)(void 0),[u,c]=(0,m.useState)(void 0),p=(0,m.useCallback)((async e=>await(0,$.bN)(o,e)),[o]);(0,m.useEffect)((()=>{d(null);t.ouId&&(async()=>{const e=await p(t.ouId);d(e)})()}),[t]),(0,m.useEffect)((()=>{if(c(null),null!=r&&r.children.length){const t=(e=r.children[0].level,a.find((t=>t.level===e)));t&&c(t)}var e}),[r]);const h={display:"inline-block",minWidth:200};return r?m.createElement(ht.N,{reference:s,placement:"right-start",dataTest:l},m.createElement(vt.n,null,m.createElement(gt.D,{dense:!0,label:y.A.t("Change org unit"),dataTest:`${l}-org-unit`},(null==r?void 0:r.parent)&&m.createElement(m.Fragment,null,m.createElement(gt.D,{dense:!0,icon:m.createElement(Et,null),label:m.createElement("span",{style:h},r.parent.name),onClick:()=>i({ou:{id:r.parent.id}}),dataTest:`${l}-org-unit-drill-up`}),u&&m.createElement(bt.c,null)),u&&m.createElement(gt.D,{dense:!0,icon:m.createElement(yt,null),label:m.createElement("span",{style:h},y.A.t("{{level}} level in {{orgunit}}",{level:u.name,orgunit:r.name})),onClick:()=>i({ou:{id:r.id,path:r.path,level:u.id}}),dataTest:`${l}-org-unit-drill-down`})))):null};wt.propTypes={config:p().object,dataTest:p().string,ouLevels:p().array,reference:p().object,onClick:p().func};const Tt=wt;var xt=a(8280),At=a(2245),_t=a(5338),Dt=a(3929),Ct=a(1324),Ot=a(2431),zt=a(8155),Lt=a(4621),Nt=a(473);const It="OutlierTablePlugin_pluginContainer__DW9Af",Mt="OutlierTablePlugin_visualizationContainer__oKzpm",Rt="OutlierTablePlugin_dataTable__iG5c9",kt="OutlierTablePlugin_headerCell__ZHDYk",Vt="OutlierTablePlugin_fontSizeLarge__W+TKN",qt="OutlierTablePlugin_fontSizeNormal__Vfxb9",Pt="OutlierTablePlugin_fontSizeSmall__B50-N",$t="OutlierTablePlugin_sizeComfortable__C+BHi",jt="OutlierTablePlugin_sizeNormal__SKU6y",Wt="OutlierTablePlugin_sizeCompact__Mnet+",Ht="OutlierTablePlugin_cell__AsAKf",Ut="OutlierTablePlugin_nowrap__a7IqD",Yt=e=>{let{filters:t,responses:a,visualization:n,onDataSorted:i}=e;const s=a[0],l=(()=>{var e,t,a,n;const i=(0,v.m3)();return{dxname:{label:null===(e=i[v.wG])||void 0===e?void 0:e.name},ouname:{label:null===(t=i[v.Yy])||void 0===t?void 0:t.name},ounamehierarchy:{label:null===(a=i[v.Yy])||void 0===a?void 0:a.name},pename:{label:null===(n=i[v.xJ])||void 0===n?void 0:n.name},cocname:{label:y.A.t("Category option combination")},value:{label:y.A.t("Value")},absdev:{label:y.A.t("Absolute deviation"),tooltip:y.A.t("A measure of the absolute difference between each data point and a central value, usually the mean or median, providing a straightforward understanding of dispersion in the dataset.")},modifiedzscore:{label:y.A.t("Modified Z-score"),tooltip:y.A.t("A measure of how far a data point deviates from the median, using the median absolute deviation instead of the standard deviation, making it robust against outliers.")},median:{label:y.A.t("Median"),tooltip:y.A.t("The middle value in a dataset when the values are arranged in ascending or descending order. It's a robust measure of central tendency that is less affected by outliers compared to the mean.")},medianabsdeviation:{label:y.A.t("Median absolute deviation"),tooltip:y.A.t("A robust measure of variability, found by calculating the median of the absolute differences between each data point and the overall median. It's less influenced by outliers compared to other measures like the standard deviation.")},zscore:{label:y.A.t("Z-score"),tooltip:y.A.t("A measure of how many standard deviations a data point is from the mean of a dataset, providing insight into how unusual or typical that data point is relative to the rest of the distribution.")},mean:{label:y.A.t("Mean"),tooltip:y.A.t("Average of the value over time.")},stddev:{label:y.A.t("Standard deviation"),tooltip:y.A.t("A measure of how dispersed the data is in relation to the mean. Low standard deviation indicates data are clustered tightly around the mean, and high standard deviation indicates data are more spread out.")},lowerbound:{label:y.A.t("Min"),tooltip:y.A.t("Minimum score threshold")},upperbound:{label:y.A.t("Max"),tooltip:y.A.t("Maximum score threshold")}}})(n.showHierarchy),o=(0,m.useRef)(null),[r,d]=(0,m.useState)({containerMaxWidth:0,paginationMaxWidth:0,noticeBoxMaxWidth:0}),u=(0,m.useMemo)((()=>({dimension:"value",direction:"desc"})),[]),c=(0,m.useCallback)((e=>{const t=je(e)||u;return{sortField:t.dimension,sortDirection:t.direction}}),[u]),{sortField:p,sortDirection:h}=c(n),g=(e=>{switch(e){case"COMFORTABLE":return $t;case"COMPACT":return Wt;default:return jt}})(n.displayDensity),b=(e=>{switch(e){case"LARGE":return Vt;case"SMALL":return Pt;default:return qt}})(n.fontSize),f=!(null==t||!t.relativePeriodDate),S=(0,m.useCallback)((()=>{if(null==o||!o.current||0===o.current.clientWidth)return;const e=o.current.clientWidth,t=o.current.querySelector(".tablescrollbox"),a=t.offsetWidth-t.clientWidth,n=e-a;d({containerMaxWidth:n,paginationMaxWidth:n-a,noticeBoxMaxWidth:t.offsetWidth})}),[]),E=(0,m.useMemo)((()=>new window.ResizeObserver(S)),[S]),w=(0,m.useCallback)((e=>{if(null!==e)return o.current=e,E.observe(e),E.disconnect}),[E]),T=e=>{let{name:t}=e;i({dimension:t,direction:p===t&&"desc"===h?"asc":"desc"})};return m.createElement("div",{className:It,ref:w},m.createElement("div",{"data-test":"visualization-container",className:Mt,style:{maxWidth:r.containerMaxWidth}},m.createElement(Ct.b,{scrollHeight:(e=>e?"calc(100vh - 285px)":"100%")(f),scrollWidth:"100%",width:"auto",className:B()(Rt,"push-analytics-outlier-table"),dataTest:"outlier-table"},m.createElement(Ot.n,null,m.createElement(zt.J,null,s.headers.map((e=>(e=>{var t,a;let{name:n,valueType:i}=e;const s=null===(t=l[n])||void 0===t?void 0:t.label,o=null===(a=l[n])||void 0===a?void 0:a.tooltip;return m.createElement(_t.w,{fixed:!0,top:"0",key:n,name:n,onSortIconClick:i!==xt.DD?void 0:T,sortDirection:i!==xt.DD?void 0:n===p?h:"default",sortIconTitle:n===p&&"desc"===h?y.A.t("Sort ascending by {{columnName}} and update",{columnName:s}):y.A.t("Sort descending by {{columnName}} and update",{columnName:s}),className:B()(kt,b,g,"bordered"),dataTest:"table-header"},o?m.createElement(Dt.m,{content:o},s):s)})(e))))),m.createElement(Lt.B,{dataTest:"table-body"},s.rows.map(((e,t)=>m.createElement(zt.J,{key:t,dataTest:"table-row"},e.map(((e,t)=>{return m.createElement(Nt.B,{key:t,className:B()(Ht,b,g,{[Ut]:(a=s.headers[t],[xt.DD,xt.qz,xt.cX,xt.OC,xt.ht,xt.eU,xt.w4,xt.pM,xt.ic,xt.lQ].includes(a.valueType))},"bordered"),dataTest:"table-cell"},((e,t)=>(0,At.A)(e,t.valueType||xt.PU,t.optionSet?{}:{digitGroupSeparator:n.digitGroupSeparator,skipRounding:!1}))(e,s.headers[t]));var a})))))))))};Yt.defaultProps={style:{},onDataSorted:Function.prototype},Yt.propTypes={responses:p().arrayOf(p().object).isRequired,visualization:p().object.isRequired,filters:p().object,onDataSorted:p().func};const Ft=Yt;var Gt=a(4745);const Kt=e=>{let{responses:t,legendSets:a,visualization:n,style:i,id:s,onToggleContextualMenu:l}=e;return m.createElement("div",{style:i},m.createElement(Gt.A,{visualization:n,data:t[0].response,legendSets:a,renderCounter:s,onToggleContextualMenu:l}))};Kt.defaultProps={style:{}},Kt.propTypes={legendSets:p().arrayOf(p().object).isRequired,responses:p().arrayOf(p().object).isRequired,visualization:p().object.isRequired,id:p().number,style:p().object,onToggleContextualMenu:p().func};const Bt=Kt,Jt="VisualizationPlugin_container__zLI-6",Zt="VisualizationPlugin_modal__aqvfr",Xt="VisualizationPlugin_chartWrapper__qJc7d",Qt="VisualizationPlugin_legendKey__rY4a7",ea="VisualizationPlugin_legendKeyToggle__yN1ab",ta="VisualizationPlugin_wrapper__qtDqn",aa="VisualizationPlugin_buttonMargin__Zo0d5",na=e=>{var t,a;let{visualization:s,displayProperty:l,filters:o,forDashboard:r,id:d,isInModal:u,style:c,onChartGenerated:p,onError:h,onLoadingComplete:g,onDataSorted:b,onResponsesReceived:S,onDrill:E}=e;const w=(0,n.ow)(),[T,x]=(0,m.useState)(null),[A,_]=(0,m.useState)(void 0),[D,C]=(0,m.useState)(null),[O,z]=(0,m.useState)(void 0),[L,N]=(0,m.useState)({}),[I,M]=(0,m.useState)(!1),[R,k]=(0,m.useState)(d),[V,q]=(0,m.useState)({width:0,height:0}),P=(0,m.useCallback)((e=>{if(null===e||0===e.clientWidth&&0===e.clientHeight)return;const t=()=>q({width:e.clientWidth,height:e.clientHeight}),a=new window.ResizeObserver(t);return a.observe(e),t(),a.disconnect}),[]);(0,m.useEffect)((()=>k(d)),[d]);const K=(e,t)=>{if(t.ouId)N(t),z(e);else if(t.category&&(1===T.rows.length&&T.rows[0].dimension===v.Yy||2===T.rows.length&&T.rows[1].dimension===v.Yy)){var a;const n=null===(a=Object.values(D.responses[0].metaData.items).find((e=>e.name===t.category&&D.responses[0].metaData.dimensions[v.Yy].includes(e.uid))))||void 0===a?void 0:a.uid;N({ouId:n}),z(e)}else if(t.category&&T.columns.some((e=>e.dimension===v.Yy))){var n;const a=null===(n=Object.values(D.responses[0].metaData.items).find((e=>e.name===t.series&&D.responses[0].metaData.dimensions[v.Yy].includes(e.uid))))||void 0===n?void 0:n.uid;N({ouId:a}),z(e)}},X=()=>z(void 0),Q=(0,m.useCallback)((async(e,t,a)=>{const n=await ut({dataEngine:w,visualization:e,filters:t,forDashboard:a,displayProperty:l});return n.responses.length&&S(n.responses),n}),[w,l,S]),ee=(0,m.useCallback)((async e=>{if(!e.length)return[];return await(async(e,t)=>(await e.query({legendSets:Z},{variables:{ids:t}})).legendSets.legendSets)(w,e)}),[w]);if((0,m.useEffect)((()=>{(async()=>{const e=await(0,$.k8)(w);_(e)})()}),[w]),(0,m.useEffect)((()=>{C(null),x(null);const e=(e=>{let{visType:t,options:a}=e;const n={};for(const[e,i]of Object.entries(a))switch(e){case"cumulativeValues":{const e=y.A.t("Not supported when using cumulative values");t===f.eh&&i&&(n.colTotals={},n.colSubTotals={},n.rowTotals={},n.rowSubTotals={},n.numberType={helpText:e},n.legend={helpText:e});break}}return n})({visType:s.type,options:me(s)}),t=(0,J.A)(s),a=(0,j.t)(t,v.Yy);if(a.length){const e=Object.entries({TODAY:y.A.t("Today"),YESTERDAY:y.A.t("Yesterday"),LAST_3_DAYS:y.A.t("Last 3 days"),LAST_7_DAYS:y.A.t("Last 7 days"),LAST_14_DAYS:y.A.t("Last 14 days"),THIS_WEEK:y.A.t("This week"),LAST_WEEK:y.A.t("Last week"),LAST_4_WEEKS:y.A.t("Last 4 weeks"),LAST_12_WEEKS:y.A.t("Last 12 weeks"),LAST_52_WEEKS:y.A.t("Last 52 weeks"),WEEKS_THIS_YEAR:y.A.t("Weeks this year"),THIS_MONTH:y.A.t("This month"),LAST_MONTH:y.A.t("Last month"),LAST_3_MONTHS:y.A.t("Last 3 months"),LAST_6_MONTHS:y.A.t("Last 6 months"),LAST_12_MONTHS:y.A.t("Last 12 months"),MONTHS_THIS_YEAR:y.A.t("Months this year"),THIS_BIMONTH:y.A.t("This bimonth"),LAST_BIMONTH:y.A.t("Last bimonth"),LAST_6_BIMONTHS:y.A.t("Last 6 bimonths"),BIMONTHS_THIS_YEAR:y.A.t("Bimonths this year"),THIS_QUARTER:y.A.t("This quarter"),LAST_QUARTER:y.A.t("Last quarter"),LAST_4_QUARTERS:y.A.t("Last 4 quarters"),QUARTERS_THIS_YEAR:y.A.t("Quarters this year"),THIS_SIX_MONTH:y.A.t("This six-month"),LAST_SIX_MONTH:y.A.t("Last six-month"),LAST_2_SIXMONTHS:y.A.t("Last 2 six-months"),THIS_FINANCIAL_YEAR:y.A.t("This financial year"),LAST_FINANCIAL_YEAR:y.A.t("Last financial year"),LAST_5_FINANCIAL_YEARS:y.A.t("Last 5 financial years"),THIS_YEAR:y.A.t("This year"),LAST_YEAR:y.A.t("Last year"),LAST_5_YEARS:y.A.t("Last 5 years"),[W.mp]:y.A.t("User organisation unit"),[W.Qj]:y.A.t("User sub-units"),[W._2]:y.A.t("User sub-x2-units")}).reduce(((e,t)=>{let[a,n]=t;return{...e,[a]:{id:a,name:n}}}),{}),t=[W.mp,W.Qj,W._2];a.forEach((a=>{t.forEach((t=>{a.id===t&&(a.name=e[t].name)}))}))}Object.keys(e).forEach((e=>delete t[e]));(async()=>{var e,a,n,i,s,l,d,u;const{responses:c,extraOptions:p}=await Q(t,o,r),m=(null===(e=c[0].metaData.dimensions)||void 0===e?void 0:e.dx)||[];if(Boolean(null===(a=t.icons)||void 0===a?void 0:a.length)&&m[0]&&null!==(n=c[0].metaData.items[m[0]])&&void 0!==n&&null!==(i=n.style)&&void 0!==i&&i.icon){const e=(await fetch(c[0].metaData.items[m[0]].style.icon,{method:"GET",credentials:"include"}).then((e=>200!==e.status?"<svg></svg>":e.text()))).replaceAll("#333333","currentColor");p.icon=e}const h=[];switch(null===(s=t.legend)||void 0===s?void 0:s.strategy){case H.YW:null!==(l=t.legend)&&void 0!==l&&null!==(d=l.set)&&void 0!==d&&d.id&&h.push(t.legend.set.id);break;case H.UB:m.forEach((e=>{const t=c[0].metaData.items[e].legendSet;t&&h.push(t)}))}const v=await ee(h);C({visualization:t,legendSets:v,responses:c,extraOptions:p}),M(null===(u=t.legend)||void 0===u?void 0:u.showKey),g()})().catch((e=>{h(e)}))}),[s,o,r]),(0,m.useEffect)((()=>{null!=D&&D.visualization&&A&&x((0,U.N)(A,D.visualization))}),[null==D?void 0:D.visualization,A]),!D||!T||!A)return null;const te=null==O?void 0:O.getBoundingClientRect(),ae=te?{getBoundingClientRect:()=>te}:null;let ne=[];switch(null===(t=D.visualization.legend)||void 0===t?void 0:t.strategy){case H.UB:{if(D.visualization.type!==f.eh&&!D.visualization.columns.some((e=>e.dimension===v.wG)))break;const e=Object.values(D.responses[0].metaData.items).filter((e=>D.legendSets.map((e=>e.id)).includes(e.legendSet))).map((e=>({itemId:e.uid,legendSet:e.legendSet}))),t=(D.visualization.series||[]).filter((e=>e.type===f.N8)).map((e=>e.dimensionItem));ne=D.legendSets.filter((a=>e.filter((e=>!t.includes(e.itemId))).map((e=>e.legendSet)).includes(a.id)))}break;case H.YW:ne=D.legendSets}const ie=(null===(a=ne)||void 0===a?void 0:a.length)>0&&(0,f.aY)(D.visualization.type);let se=c;r&&ie?se={...c,width:c.width||V.width-(I?200:36)}:u&&(se={...c,width:c.width||V.width,height:c.height||V.height}),se.height||(se.height=V.height||"100%"),se.width||(se.width=V.width||"100%");return m.createElement("div",{className:B()(Jt,{[Zt]:u}),ref:P},m.createElement("div",{className:Xt},D.visualization.type&&D.visualization.type!==f.eh?D.visualization.type===f.qr?m.createElement(Ft,{visualization:T,responses:D.responses,filters:o,id:d,style:se,onDataSorted:b}):m.createElement(mt,{visualization:T,responses:D.responses,extraOptions:D.extraOptions,legendSets:ne,onToggleContextualMenu:E?K:void 0,id:r?R:d,onChartGenerated:p,style:se}):m.createElement(Bt,{visualization:T,responses:D.responses,legendSets:ne,onToggleContextualMenu:E?K:void 0,id:d,style:se})),ie&&r?m.createElement(m.Fragment,null,I&&m.createElement("div",{className:Qt,"data-test":"visualization-legend-key"},m.createElement("div",{className:B()(ta,aa)},m.createElement(Y.A,{legendSets:ne}))),m.createElement("div",{className:ea},m.createElement(F.$,{small:!0,secondary:!0,onClick:()=>{M(!I),k(R+1)},icon:m.createElement(G.A,null),toggled:I}))):ie&&null!==(le=D.visualization.legend)&&void 0!==le&&le.showKey?m.createElement("div",{className:Qt,"data-test":"visualization-legend-key"},m.createElement("div",{className:ta},m.createElement(Y.A,{legendSets:ne}))):void 0,te&&m.createElement(i.W,{onClick:X,dataTest:"visualization-drill-down-backdrop"},m.createElement(Tt,{reference:ae,config:L,ouLevels:A,onClick:e=>{X(),E(e)},dataTest:"visualization-drill-down-menu"})));var le};function ia(){return ia=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},ia.apply(this,arguments)}na.defaultProps={displayProperty:"name",filters:{},forDashboard:!1,onChartGenerated:Function.prototype,onError:Function.prototype,onLoadingComplete:Function.prototype,onDataSorted:Function.prototype,onResponsesReceived:Function.prototype,style:{},visualization:{}},na.propTypes={displayProperty:p().string.isRequired,visualization:p().object.isRequired,filters:p().object,forDashboard:p().bool,id:p().number,isInModal:p().bool,style:p().object,onChartGenerated:p().func,onDataSorted:p().func,onDrill:p().func,onError:p().func,onLoadingComplete:p().func,onResponsesReceived:p().func};const sa=e=>{const[t,a]=(0,m.useState)(e),[n,i]=(0,m.useState)(!0),[o,r]=(0,m.useState)(null),d=(0,m.useCallback)((e=>{i(!0);const n={dimension:e.dimension,direction:e.direction.toUpperCase()};a({...t,visualization:{...t.visualization,sorting:[n]}})}),[t]);(0,m.useEffect)((()=>{a({displayProperty:e.displayProperty,visualization:e.visualization,filters:e.filters,forDashboard:e.forDashboard,id:e.id,isInModal:e.isInModal,style:e.style,onChartGenerated:e.onChartGenerated,onDrill:e.onDrill,onError:e.onError,onResponsesReceived:e.onResponsesReceived})}),[e.displayProperty,e.visualization,e.filters,e.forDashboard,e.id,e.isInModal,e.style,e.onChartGenerated,e.onDrill,e.onError,e.onResponsesReceived]),(0,m.useEffect)((()=>{i(!0)}),[e.filters,e.forDashboard,e.visualization]);const{visualization:u,onResponsesReceived:c}=e,p=(0,m.useCallback)((e=>{try{((e,t)=>{if(!e.some((e=>e.rows&&e.rows.length>0))){if(t===f.qr)throw new N;throw new L}})(e,u.type)}catch(e){r(e)}"function"==typeof c&&c(e)}),[u.type,c]);return o?m.createElement(P,{error:o}):m.createElement(m.Fragment,null,n&&m.createElement(h.Y,null,m.createElement(s.o,null,m.createElement(l.F,null))),m.createElement(na,ia({},t,{onDataSorted:d,onLoadingComplete:()=>i(!1),onResponsesReceived:p})))};sa.propTypes={displayProperty:p().string.isRequired,visualization:p().object.isRequired,className:p().string,filters:p().object,forDashboard:p().bool,id:p().number,isInModal:p().bool,style:p().object,onChartGenerated:p().func,onDrill:p().func,onError:p().func,onResponsesReceived:p().func};const la="READY",oa="INSTALLING";function ra(e){let{installingWorker:t,onStateChange:a}=e;t.onstatechange=()=>{"activated"===t.state&&a(la)}}function da(){return da=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},da.apply(this,arguments)}const ua=()=>m.createElement(i.W,null,m.createElement(s.o,null,m.createElement(l.F,null))),ca=e=>{let{id:t,children:a,cacheNow:i,isParentCached:s}=e;const{startRecording:l,isCached:o,remove:r}=(0,n.$t)(t);return(0,m.useEffect)((()=>{i&&l({onError:console.error})}),[i]),(0,m.useEffect)((()=>{const e=d().on("removeCachedData",{window:window.parent},(()=>r()));return()=>e.cancel()}),[r]),(0,m.useEffect)((()=>{!s&&o&&r()}),[s]),m.createElement(n.M9,{id:t,loadingMask:ua},a)};ca.propTypes={cacheNow:p().bool,children:p().node,id:p().string,isParentCached:p().bool};const pa=e=>{d().send(window.parent,"installationStatus",{installationStatus:e})},ma=()=>{const[e,t]=(0,m.useState)(),[a,n]=(0,m.useState)(null),i=e=>t(e.data);return(0,m.useEffect)((()=>{d().send(window.parent,"getProps").then(i).catch((e=>console.error(e))),async function(e){let{onStateChange:t}=e;if(!navigator.serviceWorker)return null;const a=await navigator.serviceWorker.getRegistration();return a?a.active?la:a.installing?(ra({installingWorker:a.installing,onStateChange:t}),oa):(a.onupdatefound=()=>{t(oa);const e=a.installing;e&&ra({installingWorker:e,onStateChange:t})},null):null}({onStateChange:pa}).then(pa);const e=d().on("newProps",{window:window.parent},i);return()=>e.cancel()}),[]),(0,m.useLayoutEffect)((()=>{const e=(0,u.A)((()=>n((e=>"number"==typeof e?e+1:1))),300);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),e?m.createElement("div",{style:{display:"flex",height:"100%",overflow:"hidden"}},m.createElement(ca,{id:e.cacheId,cacheNow:e.recordOnNextLoad,isParentCached:e.isParentCached},m.createElement(sa,da({id:a},e))),m.createElement(o.L,{colors:!0,spacers:!0,elevations:!0})):null}},477:()=>{},1234:()=>{}}]);